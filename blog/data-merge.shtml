<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<!-- Весь хедер и стили -->
		<!--#include virtual="/includes/header.html"-->
		<title>Нумерация в индизайне</title>
	</head>
<body>

<div class="wrapper">

	<!-- Меню главное -->
	<!--#include virtual="/includes/mainMenu.html"-->


	<div class="grid">

		<!-- Заголовок статьи -->
		<div class="artHeader">
			Нумерация в индизайне
		</div>

		<div class="whoDid">Автор — <a href="/blog/marat-bakirov.shtml">Марат Бакиров</a>. 08.08.2015 г.</div><br><br>

		Всем привет! Сегодня расскажу о&nbsp;том, как сделать нумерацию в&nbsp;индизайне. Эта функция называется <b>&laquo;Объединение данных&raquo;</b> и&nbsp;принцип её&nbsp;работы заключается в&nbsp;том, что вы&nbsp;можете вставлять в&nbsp;индизайновский документ динамические данные из&nbsp;отдельного файла. Для новичков, возможно, звучит мудрено, но&nbsp;по&nbsp;ходу дела всё станет понятно.<br>
		Чтобы создать файл с&nbsp;данными, нам понадобится эксель. В&nbsp;моем случае лицензии на&nbsp;эксель нет, поэтому я&nbsp;заменяю его бесплатным Опен Офисом.<br>
		<br>
		Мы&nbsp;рассмотрим несколько вариантов применения этой функции и&nbsp;начнём, как водится, с&nbsp;простого.<br>
		<br>
		Итак, предположим, что у&nbsp;нас есть документ, который представляет из&nbsp;себя входной билет в&nbsp;цирк. В&nbsp;определенном месте на&nbsp;билете должен стоять уникальный порядковый номер. Всего у&nbsp;нас 100&nbsp;билетов. Допустим, номер должен стоять в&nbsp;двух местах&nbsp;&mdash; на&nbsp;отрывном корешке и&nbsp;на&nbsp;основной части.<br><br>

		<img src="/blog/images/date-merge_1.jpg"><br><br>

		На&nbsp;скриншоте наш простенький понарошковый билет и&nbsp;открытая панель &laquo;Объединение данных&raquo; справа. Панелька эта открывается в&nbsp;меню <b>Окно &gt; Автоматизация &gt; Объединение данных.</b><br>
		<br>
		Теперь нам нужно создать файлик, откуда индизайн будет брать нужные нам данные. Для этого открываем эксель и&nbsp;создаем новый документ. В&nbsp;первой ячейке мы&nbsp;пишем название данных&nbsp;&mdash; <b>NOMER</b>, и&nbsp;первую колонку заполняем нужной информацией. В&nbsp;нашем случае это порядковый номер от&nbsp;одного до&nbsp;ста.<br>
		Важный совет&nbsp;&mdash; чтобы не&nbsp;набивать руками кучу цифр в&nbsp;экселе, можно вбить только первые два, потом выделить&nbsp;их, навести мышку на&nbsp;нижний правый угол последней выбранной ячейки до&nbsp;тех пор, пока не&nbsp;появится черный прямой крестик. После этого нужно протянуть ячейки вниз до&nbsp;тех пор, пока не&nbsp;заполним нужное количество. Вот гифка.<br><br>

		<img src="/blog/images/data-merge_2.gif" class="roundShadow"><br><br>

		После того, как эксель вставил цифры, нам нужно добавить нули в&nbsp;начале. Для этого мы&nbsp;выделяем всю колонку, переходим в&nbsp;меню <b>Формат &gt; Ячейки</b> и&nbsp;в&nbsp;поле &laquo;Начальные нули&raquo; задаём нужное количество. В&nbsp;моем случае это 3.<br><br>

		<img src="/blog/images/data-merge_3.png" class="roundShadow"><br><br>

		Если у&nbsp;вас Эксель от&nbsp;Майкрософта, а&nbsp;не&nbsp;Калк от&nbsp;Опен Офиса, тогда у&nbsp;вас, наверное, добавлять разрядность надо как-то иначе. Но,&nbsp;в&nbsp;целом, там должно быть всё примерно так&nbsp;же.<br>
		После этих манипуляций цифра 1&nbsp;превратится в&nbsp;001, а&nbsp;цифра 15&nbsp;в 015. Сохраните этот документ, но&nbsp;не&nbsp;закрывайте его. Его нужно сохранить ещё раз, в&nbsp;формате .csv<br>
		<br>
		Далее мы&nbsp;должны указать, где лежит файл и&nbsp;куда вставлять данные. Для этого находим панельку <b>&laquo;Объединение данных&raquo;</b> в&nbsp;правом верхнем углу, открываем её&nbsp;свойства и&nbsp;нажимаем на&nbsp;выбор источника данных. Находим наш .csv файл, и&nbsp;он&nbsp;добавляется в&nbsp;панельку. Если у&nbsp;вас возникли проблемы с&nbsp;кодировкой, тогда при выборе источника данных поставьте галочку на&nbsp;чекбоксе &laquo;Показать параметры импорта&raquo; и&nbsp;выберите тип декодирования ASCII.<br>
		<br>
		Далее всё очень просто. Мы&nbsp;переходим во&nbsp;фрейм, в&nbsp;который хотим вставить нумерацию, и&nbsp;просто нажимаем в&nbsp;панельке <b>&laquo;Объединение данных&raquo;</b> на&nbsp;ту&nbsp;колонку, которую нужно вставить. В&nbsp;моём случае колонка называлась NOMER.<br><br>

		<img src="/blog/images/data-merge_4.png"><br><br>

		На&nbsp;этом мы&nbsp;почти закончили. Осталось только проверить, всё&nbsp;ли правильно вставилось. Для этого в&nbsp;нашей замечательной панельке предусмотрен чекбокс &laquo;Просмотр&raquo;, нажав на&nbsp;который, мы&nbsp;увидим, как всё будет выглядеть в&nbsp;итоге.<br>
		<br>
		Последним шагом мы&nbsp;экспортируем всё это дело в&nbsp;PDF или создаём новый файл в&nbsp;индизайне, в&nbsp;котором будет столько страниц, сколько у&nbsp;вас строк данных. В&nbsp;этом случае получится 100-страничный файл.<br><br>

		<img src="/blog/images/data-merge_5.png" class="roundShadow"><br><br><br>

		Наши пронумерованные входные билеты в&nbsp;цирк готовы. Давайте перейдем к&nbsp;примеру посложнее.<br><br>

		Предположим, в&nbsp;нашем воображаемом цирке работает 10&nbsp;человек, и&nbsp;всем им&nbsp;периодически нужно печатать визитки. Чтобы ускорить процесс их&nbsp;подготовки и&nbsp;в&nbsp;будущем вносить правки быстрее, мы&nbsp;подготовили два файла&nbsp;&mdash; шаблон в&nbsp;индизайне и&nbsp;данные в&nbsp;экселе.<br><br>

		<img src="/blog/images/data-merge_6.png"><br><br>
		<img src="/blog/images/data-merge_7.png" class="roundShadow"><br><br>

		Далее мы&nbsp;сохраняем наши данные в .csv и&nbsp;линкуем их&nbsp;в&nbsp;индизайн. Как и&nbsp;с&nbsp;прошлым примером, мы&nbsp;проставляем наши данные в&nbsp;нужные места макета. Обратите внимание, что адрес цирка и&nbsp;его сайт я&nbsp;не&nbsp;стал делать в&nbsp;виде динамических данных. Потому что они неизменны во&nbsp;всех визитках.<br><br>

		<img src="/blog/images/data-merge_8.jpg"></img><br><br>

		Теперь всё готово. Осталось только проверить, что у&nbsp;нас получилось, и&nbsp;экспортнуть результат в&nbsp;ПДФ.<br><br>

		<img src="/blog/images/data-merge_9.gif"><br><br><br>

		Надеюсь, вы&nbsp;разобрались, как можно применять эту функцию на&nbsp;практике. Я&nbsp;хотел добавить в&nbsp;эту заметку более сложный пример, но&nbsp;всё-таки отложу его до&nbsp;следующего раза.<br>
		<br>
		Естественно, когда вам нужно сделать 10&nbsp;визиток, проще не&nbsp;заморачиваться и&nbsp;сделать их&nbsp;вручную. Но&nbsp;если в&nbsp;вашей компании работает 2000&nbsp;человек? Вы&nbsp;можете запросить у&nbsp;программистов готовый .csv файл с&nbsp;данными по&nbsp;сотрудникам, подготовить шаблон в&nbsp;индизайне и,&nbsp;линканув файл, сверстать всё одним махом!<br>
		<br>
		Почти как кнопка &laquo;Сверстать&raquo;, да?<br><br>

		По традиции выкладываю индизайновский файл, можете посмотреть, как там что сделано.<br><br><br>

		<a href="/blog/images/data-merge-viz.zip"><img src="/blog/images/TOC_09.png" style="margin: 0 0 0 -22px;"></a>


		<br><br><br>&para;<br><br><br>

		<!--#include virtual="/includes/disqus.html"-->
		
	</div>

<div class="footerPush"></div>
</div>

	<!-- Футер -->
	<!--#include virtual="/includes/footer.html"-->

</body>
</html>